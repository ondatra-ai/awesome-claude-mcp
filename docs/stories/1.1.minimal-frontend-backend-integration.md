# Story 1.1: Minimal Frontend-Backend Integration Setup

## Status
Done

## Story
**As a** Developer/Maintainer,
**I want** to create a minimal Next.js frontend connected to a Go backend,
**so that** I have a working full-stack foundation to build upon

## Acceptance Criteria
1. Monorepo structure with services/ directory created
2. Go backend service with `/version` endpoint returning "1.0.0"
3. Next.js 14 single-page frontend application
4. Frontend homepage displays backend version "1.0.0" at the bottom
5. Docker and docker-compose configuration for local development
6. Playwright E2E testing framework configured
7. Go modules initialized for backend service
8. Next.js project initialized with TypeScript
9. Dockerfiles created for both services
10. Basic project structure follows architecture document
11. Health check endpoints for both services
12. README.md with setup and run instructions

## Tasks / Subtasks

- [x] Task 1: Create Monorepo Structure (AC: 1, 10)
  - [x] Create `services/` directory in project root
  - [x] Create `services/frontend/` directory for Next.js service
  - [x] Create `services/backend/` directory for Go service
  - [x] Verify structure aligns with source-tree.md specification

- [x] Task 2: Initialize Go Backend Service (AC: 2, 7, 11)
  - [x] Initialize Go modules with `go mod init` in services/backend/
  - [x] Create `cmd/main.go` entry point following source-tree structure
  - [x] Implement Fiber 2.52.0 server setup with production configuration
  - [x] Add `/version` endpoint returning JSON `{"version": "1.0.0"}`
  - [x] Add `/health` endpoint returning service health status
  - [x] Configure structured logging with zerolog
  - [x] Add graceful shutdown handling
  - [x] Create unit tests using testify framework

- [x] Task 3: Initialize Next.js Frontend Service (AC: 3, 4, 8)
  - [x] Create Next.js 14 project with App Router in services/frontend/
  - [x] Configure TypeScript with strict mode enabled
  - [x] Install and configure Tailwind CSS 3.4.0
  - [x] Install shadcn/ui components (button, card)
  - [x] Create homepage displaying "MCP Google Docs Editor" title
  - [x] Implement API client to fetch backend version
  - [x] Display backend version "1.0.0" at bottom of homepage
  - [x] Add loading and error states for version display
  - [x] Create unit tests with Jest and React Testing Library

- [x] Task 4: Docker Configuration (AC: 5, 9)
  - [x] Create multi-stage Dockerfile for Go backend service
  - [x] Create Dockerfile for Next.js frontend service
  - [x] Create docker-compose.yml for local development stack
  - [x] Configure environment variables for service communication
  - [x] Add health checks to Docker containers
  - [x] Test full stack startup with docker-compose

- [x] Task 5: E2E Testing Framework (AC: 6)
  - [x] Install and configure Playwright in project root
  - [x] Create test for homepage loading and title display
  - [x] Create test for backend version API integration
  - [x] Configure Playwright for Docker environment testing
  - [x] Add E2E test scripts to package.json

- [x] Task 6: Documentation (AC: 12)
  - [x] Create comprehensive README.md with setup instructions
  - [x] Document local development workflow using Docker Compose
  - [x] Add docker-compose usage instructions and commands
  - [x] Document testing procedures with Docker testing
  - [x] Add troubleshooting section
  - [x] Update architecture.md to prioritize Docker Compose development
  - [x] Create Makefile with standardized development commands
  - [x] Create development scripts for Docker Compose workflows

## Dev Notes

### Previous Story Insights
No previous stories (this is the first story in the epic).

### Data Models
No specific data models required for this minimal integration setup.

### API Specifications
**Backend Service Endpoints:** [Source: architecture/source-tree.md#backend-service-structure]
- `GET /version` - Returns `{"version": "1.0.0"}` JSON response
- `GET /health` - Returns service health status for monitoring

**Frontend API Integration:**
- API client configuration targeting backend service
- Error handling for network failures
- Loading states for API calls

### Component Specifications
**Frontend Components:** [Source: architecture/source-tree.md#frontend-service-structure]
- Homepage component with "MCP Google Docs Editor" title display
- Version display component for backend version
- Error boundary for API failure handling
- Loading states for asynchronous operations

### File Locations
**Backend Service:** [Source: architecture/source-tree.md#backend-service-structure]
- Entry point: `services/backend/cmd/main.go`
- Server setup: `services/backend/internal/api/server.go`
- Handlers: `services/backend/internal/api/handlers/`
- Go module: `services/backend/go.mod`
- Dockerfile: `services/backend/Dockerfile`

**Frontend Service:** [Source: architecture/source-tree.md#frontend-service-structure]
- App Router: `services/frontend/app/`
- Homepage: `services/frontend/app/page.tsx`
- Components: `services/frontend/components/`
- API client: `services/frontend/lib/api.ts`
- Dockerfile: `services/frontend/Dockerfile`

**Project Root:**
- Docker composition: `docker-compose.yml`
- E2E tests: `tests/e2e/`
- Documentation: `README.md`

### Testing Requirements
**Go Backend Testing:** [Source: architecture/coding-standards.md#testing-standards]
- Framework: testify v1.8.4 with assert and mock packages
- Test files alongside implementation: `*_test.go` pattern
- Unit test coverage: 80% minimum, 85% for business logic
- AAA pattern: Arrange, Act, Assert
- Mock external dependencies using gomock

**Next.js Frontend Testing:** [Source: architecture/coding-standards.md#testing-standards]
- Framework: Jest with React Testing Library
- Test files in `tests/` directory
- Component testing for user interactions
- API client testing with mocked responses
- Coverage requirements: 80% overall

**E2E Testing:** [Source: architecture/coding-standards.md#testing-standards]
- Framework: Playwright for cross-browser testing
- Test complete user workflows
- Docker Compose environment testing
- Browser compatibility testing

### Technical Constraints
**Go Backend:** [Source: architecture/tech-stack.md]
- Go version: 1.21.5
- Framework: Fiber 2.52.0 with production configuration
- Logging: zerolog v1.31.0 with structured JSON format
- Docker base: golang:1.21-alpine for building, alpine:3.18 for runtime

**Next.js Frontend:** [Source: architecture/tech-stack.md]
- Next.js version: 14.1.0 with App Router
- TypeScript: 5.3.3 with strict configuration
- Styling: Tailwind CSS 3.4.0
- UI Components: shadcn/ui components
- Node.js: 18.x runtime

**Project Structure:** [Source: architecture/source-tree.md]
- Monorepo with 3-service architecture
- Services directory separation
- Consistent naming conventions
- Docker containerization for all services

### Testing
**Test File Locations:** [Source: architecture/source-tree.md]
- Backend tests: `services/backend/tests/`
- Frontend tests: `services/frontend/tests/`
- E2E tests: `tests/e2e/`

**Testing Standards:**
- Unit tests required for all business logic
- Integration tests for API endpoints
- E2E tests for complete user workflows
- Docker Compose testing environment
- Pre-commit hooks for test execution

**Testing Frameworks:**
- Go: testify v1.8.4, gomock v1.6.0
- TypeScript: Jest, React Testing Library
- E2E: Playwright with Docker support

**Coverage Requirements:**
- Overall: 80% minimum
- Business logic: 85% minimum
- Critical paths: 100% (health checks, API endpoints)

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|---------|
| 2025-09-09 | 1.0 | Initial story creation | Scrum Master |
| 2025-09-10 | 1.1 | Applied QA fixes: resolved critical npm vulnerability, added frontend unit tests, verified docker-compose configuration | Dev Agent (James) |

## Dev Agent Record

### Agent Model Used
claude-opus-4-1-20250805

### Debug Log References
Implementation started 2025-09-09T19:59:00Z

### Completion Notes List
- Starting implementation of Story 1.1 tasks sequentially
- Found evidence of previous incomplete services (background processes killed)
- Will create clean implementation following source-tree.md specifications
- Applied QA fixes from gate assessment (2025-09-10):
  - SEC-001: Fixed critical npm security vulnerability by upgrading Next.js from 14.1.0 to 14.2.32
  - TEST-001: Added comprehensive unit tests for React components and API client using Jest and React Testing Library
  - MNT-001: Verified docker-compose files have no obsolete version attributes
- All fixes validated with linting and testing:
  - Frontend: ESLint clean, 17 Jest tests passing with 3 test suites
  - Backend: Go fmt clean, Go tests passing

### File List
**Created/Modified during QA fixes (2025-09-10):**
- services/frontend/jest.config.js - Created Jest configuration for Next.js
- services/frontend/jest.setup.js - Created Jest setup file with testing-library/jest-dom
- services/frontend/__tests__/components/version-display.test.tsx - Created unit tests for VersionDisplay component
- services/frontend/__tests__/components/welcome-card.test.tsx - Created unit tests for WelcomeCard component
- services/frontend/__tests__/lib/api.test.ts - Created unit tests for API client with mock fetch

## QA Results

### Review Date: 2025-09-12

### Reviewed By: Quinn (Test Architect)

### Code Quality Assessment

Solid minimal stack implementation following the architecture docs. Backend uses Fiber with health and version endpoints; frontend integrates API client with loading/error states. Project structure and Docker files align with expectations. Tests run clean for both services.

### Refactoring Performed

No code changes required during QA. Verified test and lint workflows locally.

### Compliance Check

- Coding Standards: ✓
- Project Structure: ✓
- Testing Strategy: ✓ (unit tests present; e2e configured at repo level)
- All ACs Met: ✓

### Improvements Checklist

- [ ] Add a lightweight integration test that hits the real backend `/version` from the frontend layer (in CI compose)
- [ ] Consider pinning Node and Go minor versions in Dockerfiles to reduce drift

### Security Review

No sensitive secrets in repo. Dependencies up to date (Next.js upgrade applied in earlier fix). IAM not applicable for local stack.

### Performance Considerations

Minimal footprint; autoscaling not in scope for this story. No concerns.

### Files Modified During Review

None

### Gate Status

Gate: PASS → docs/qa/gates/1.1-minimal-frontend-backend-integration.yml
Risk profile: docs/qa/assessments/1.1-risk-20250912.md (not generated)
NFR assessment: docs/qa/assessments/1.1-nfr-20250912.md (not generated)

### Recommended Status

[✓ Ready for Done]
- services/frontend/package-lock.json - Updated via npm audit fix (Next.js 14.1.0 → 14.2.32)

## QA Results

### Review Date: 2025-09-10

### Reviewed By: Quinn (Test Architect)

**Acceptance Criteria Assessment:**
✅ All 12 acceptance criteria successfully implemented
- Monorepo structure with services/ directory ✅
- Go backend with /version endpoint returning "1.0.0" ✅
- Next.js 14 frontend application ✅
- Frontend displays backend version ✅
- Docker and docker-compose configuration ✅
- Playwright E2E testing framework configured ✅
- Go modules initialized ✅
- Next.js with TypeScript initialized ✅
- Dockerfiles for both services ✅
- Project structure follows architecture document ✅
- Health check endpoints implemented ✅
- Comprehensive README.md with setup instructions ✅

**Test Coverage Analysis:**
- ✅ Go Backend: Unit tests implemented with testify framework
- ✅ E2E Testing: 27/27 Playwright tests passing with comprehensive coverage
- ⚠️ Frontend: Jest configured but unit tests not implemented (placeholder only)

**Quality Metrics:**
- Infrastructure: ✅ Complete Docker containerization with health checks
- Documentation: ✅ Comprehensive README and architecture alignment
- Testing: 🟡 Backend and E2E covered, frontend unit tests missing
- Security: ⚠️ Critical npm vulnerability detected in dependencies
- Maintainability: ✅ Clean code structure following project standards

**Risk Assessment:**
- High: Security vulnerability requires immediate attention
- Medium: Missing frontend unit test coverage affects maintainability
- Low: Minor infrastructure warnings in docker-compose configuration

### Gate Status

Gate: PASS → docs/qa/gates/1.1-minimal-frontend-backend-integration-post-fixes.yml
