# <!-- Powered by BMAD™ Core -->
# Story 1.2: Project Repository Setup

## Status
Draft

## Story
**As a** Developer/Maintainer,
**I want** to initialize the 3-service project structure with Frontend Service (Next.js), Backend Service (Go Fiber), and MCP Service (Mark3Labs MCP-Go),
**so that** I have a maintainable containerized codebase foundation for ECS Fargate deployment

## Acceptance Criteria
1. Go modules initialized for Backend and MCP services with proper dependencies
2. 3-service project structure follows source-tree architecture document  
3. Makefile created with build, test, deploy targets for all services
4. Git repository configured with .gitignore for all service types
5. README.md with 3-service setup instructions
6. MIT license file added
7. Docker Compose configuration for local 3-service development
8. Container definitions (Dockerfiles) for each service

## Tasks / Subtasks
- [ ] Task 1: Initialize Go modules and dependencies for all services (AC: 1)
  - [ ] Create services/backend/go.mod with module name `mcp-google-docs-editor/backend`
  - [ ] Add Backend Service dependencies: fiber, zerolog, viper, testify, gomock, golangci-lint
  - [ ] Create services/mcp-service/go.mod with module name `mcp-google-docs-editor/mcp-service`
  - [ ] Add MCP Service dependencies: Mark3Labs MCP-Go, golang.org/x/oauth2, google.golang.org/api/docs/v1
  - [ ] Add shared dependencies: go-redis/redis, goldmark
  - [ ] Run `go mod tidy` on both Go services to create go.sum lockfiles
  
- [ ] Task 2: Create complete 3-service project directory structure (AC: 2)
  - [ ] Create services/ directory for 3-service architecture
  - [ ] Create services/frontend/ directory with Next.js structure
  - [ ] Create services/backend/ directory with Go Backend Service structure
  - [ ] Create services/mcp-service/ directory with Go MCP Service structure
  - [ ] Create infrastructure/ directory with Terraform ECS Fargate structure
  - [ ] Create .github/workflows/ directory for CI/CD
  - [ ] Create scripts/ directory for build and deploy scripts
  - [ ] Create docs/stories/ and docs/architecture/ directories if missing
  
- [ ] Task 3: Create Makefile with build, test, deploy targets (AC: 3)
  - [ ] Add `build` target for Go backend compilation
  - [ ] Add `test` target for running Go tests with coverage
  - [ ] Add `deploy` target for AWS deployment
  - [ ] Add `lint` target for golangci-lint
  - [ ] Add `docker-build` target for container builds
  - [ ] Add `dev` target for local development setup

- [ ] Task 4: Configure Git repository with proper .gitignore (AC: 4)
  - [ ] Update existing .gitignore with Go-specific patterns
  - [ ] Add Node.js and Next.js ignore patterns
  - [ ] Add environment files (.env*) to gitignore
  - [ ] Add build artifacts and dependency directories
  - [ ] Add AWS and Terraform state file patterns

- [ ] Task 5: Create comprehensive README.md with setup instructions (AC: 5)
  - [ ] Add project description and architecture overview
  - [ ] Add prerequisites (Go 1.21.5, Node.js, Docker, AWS CLI)
  - [ ] Add local development setup instructions
  - [ ] Add build and deployment instructions
  - [ ] Add testing and contribution guidelines

- [ ] Task 6: Ensure MIT license file is properly configured (AC: 6)
  - [ ] Verify existing LICENSE file contains MIT license text
  - [ ] Update copyright year to 2025 if needed
  - [ ] Ensure license references the correct project name

- [ ] Task 7: Create initial configuration files for 3-service development
  - [ ] Create root-level docker-compose.yml for local 3-service development stack
  - [ ] Create services/frontend/Dockerfile for Next.js container
  - [ ] Create services/backend/Dockerfile for Go Backend Service container
  - [ ] Create services/mcp-service/Dockerfile for Go MCP Service container
  - [ ] Create .env.example files for each service with proper variable templates

## Dev Notes

### Previous Story Insights
No previous story exists - this is the first story in Epic 1.

### Tech Stack Requirements
**Go Services (Primary Language):**
- **Language**: Go 1.21.5 [Source: tech-stack.md#Backend Technologies]
- **Backend Service Framework**: Fiber 2.52.0 for HTTP routing and user management [Source: tech-stack.md#Backend Technologies]
- **MCP Service Library**: Mark3Labs MCP-Go (latest) for streamlined MCP protocol implementation [Source: tech-stack.md#MCP Protocol Library]
- **OAuth Library**: golang.org/x/oauth2 0.15.0 for Google OAuth [Source: architecture.md#Infrastructure Technologies]
- **Google API Client**: google.golang.org/api/docs/v1 0.150.0 [Source: architecture.md#Infrastructure Technologies]
- **Markdown Parser**: goldmark 1.6.0 for Markdown to AST conversion [Source: architecture.md#Infrastructure Technologies]
- **Redis Client**: go-redis/redis 9.3.0 for caching [Source: architecture.md#Infrastructure Technologies]
- **Logger**: zerolog 1.31.0 for structured JSON logging [Source: architecture.md#Infrastructure Technologies]
- **Config Management**: viper 1.17.0 for configuration [Source: architecture.md#Infrastructure Technologies]
- **Testing**: testify 1.8.4 for test assertions and mocks [Source: architecture.md#Infrastructure Technologies]
- **Mocking**: gomock 1.6.0 for interface mocking [Source: architecture.md#Infrastructure Technologies]
- **Linter**: golangci-lint 1.55.0 for code quality [Source: architecture.md#Infrastructure Technologies]

**Frontend Technologies:**
- **Framework**: Next.js 14.1.0 with App Router [Source: tech-stack.md#Frontend Technologies]
- **Language**: TypeScript 5.3.3 for type safety [Source: tech-stack.md#Frontend Technologies]
- **UI Library**: React 18.2.0 [Source: tech-stack.md#Frontend Technologies]
- **Styling**: Tailwind CSS 3.4.0 [Source: tech-stack.md#Frontend Technologies]
- **Components**: shadcn/ui for pre-built accessible components [Source: tech-stack.md#Frontend Technologies]
- **State Management**: React Hooks + SWR for server state [Source: tech-stack.md#Frontend Technologies]
- **Forms**: React Hook Form with Zod validation [Source: frontend-architecture.md#Component Standards]

**Infrastructure:**
- **Container Platform**: Docker 24.0.0 [Source: tech-stack.md#Infrastructure Technologies]
- **Base Image**: golang:1.21-alpine [Source: tech-stack.md#Infrastructure Technologies]
- **Cloud Provider**: AWS (ECS Fargate, Application Load Balancer, ElastiCache Redis) [Source: tech-stack.md#Infrastructure Technologies]
- **Container Orchestration**: ECS Fargate for serverless container management [Source: tech-stack.md#Infrastructure Technologies]
- **Deployment Strategy**: Containerized services with Infrastructure as Code using Terraform [Source: tech-stack.md#Infrastructure Technologies]

### Project Structure Specification
Complete source tree structure must match the 3-service architecture specification [Source: source-tree.md]:

```plaintext
mcp-google-docs-editor/
├── services/                       # 3-Service Architecture
│   ├── frontend/                   # Next.js Frontend Service
│   ├── app/                        # App Router directory
│   ├── components/                 # React Components
│   ├── lib/                        # Utility functions
│   ├── public/                     # Static assets
│   ├── package.json                # Frontend dependencies
│   ├── tsconfig.json               # TypeScript config
│   ├── next.config.js              # Next.js config
│   ├── tailwind.config.ts          # Tailwind config
│   ├── Dockerfile                  # Frontend container definition
│   └── .env.local                  # Frontend env vars
│   ├── backend/                    # Go Backend Service (User Management)
│   │   ├── cmd/main.go             # Backend API server entry point
│   │   ├── internal/               # Internal packages
│   │   │   ├── api/                # HTTP handlers and routes
│   │   │   ├── auth/               # OAuth and authentication
│   │   │   ├── users/              # User management
│   │   │   ├── cache/              # Redis caching
│   │   │   └── config/             # Configuration
│   │   ├── go.mod                  # Go dependencies
│   │   ├── Dockerfile              # Backend container definition
│   │   └── .env                    # Backend env vars
│   └── mcp-service/                # Go MCP Service (Mark3Labs)
│       ├── cmd/main.go             # MCP server entry point with Mark3Labs library
│       ├── internal/               # Internal packages
│       │   ├── server/             # Mark3Labs MCP server setup and configuration
│       │   ├── operations/         # Document operations business logic
│       │   ├── docs/               # Google Docs integration
│       │   ├── auth/               # OAuth for MCP service
│       │   ├── cache/              # Shared Redis caching
│       │   └── config/             # Configuration
│       ├── go.mod                  # Go module with Mark3Labs MCP-Go dependency
│       ├── Dockerfile              # MCP service container definition
│       └── .env                    # MCP service env vars
├── infrastructure/                 # Infrastructure as Code
│   ├── terraform/                  # Terraform configurations
│   └── docker/                     # Docker deployment notes
├── .github/workflows/              # GitHub Actions CI/CD
├── scripts/                        # Build and deploy scripts
├── docs/                           # Documentation
├── docker-compose.yml              # Local development stack
├── .gitignore                      # Git ignore rules
└── README.md                       # Project documentation
```

### File Locations for New Code (3-Service Architecture)
Based on the 3-service architecture, new files should be created in specific locations:
- **Frontend Service**: `services/frontend/{app,components,lib}/` [Source: source-tree.md#Frontend Service Structure]
- **Backend Service Main**: `services/backend/cmd/main.go` [Source: source-tree.md#Backend Service Structure]
- **Backend Service Logic**: `services/backend/internal/{api,auth,users,cache,config}/` [Source: source-tree.md#Backend Service Structure]
- **MCP Service Main**: `services/mcp-service/cmd/main.go` [Source: source-tree.md#MCP Service Structure]
- **MCP Service Logic**: `services/mcp-service/internal/{server,operations,docs,auth,cache,config}/` [Source: source-tree.md#MCP Service Structure]
- **Container Definitions**: `services/{frontend,backend,mcp-service}/Dockerfile` [Source: source-tree.md#Services Directory Structure]
- **Infrastructure Code**: `infrastructure/terraform/` [Source: source-tree.md#Infrastructure Directory Structure]
- **CI/CD Pipelines**: `.github/workflows/` [Source: source-tree.md#Root Directory Structure]

### Technical Constraints
**3-Service Architecture Requirements:**
- **Service Separation**: Frontend Service (Next.js), Backend Service (Go Fiber), MCP Service (Mark3Labs MCP-Go) [Source: tech-stack.md#Service Architecture]
- **Container Strategy**: Each service has its own Dockerfile for ECS Fargate deployment [Source: source-tree.md#Services Directory Structure]
- **Service Communication**: Frontend ↔ Backend API, Claude/ChatGPT ↔ MCP Service [Source: architecture.md#High Level Overview]
- **Shared Resources**: Redis cache shared between Backend and MCP services [Source: architecture.md#High Level Overview]

**Go Module Requirements:**
- **Module Names**: `mcp-google-docs-editor/backend`, `mcp-google-docs-editor/mcp-service`
- **Go Version**: Minimum Go 1.21.5 [Source: tech-stack.md#Backend Technologies]
- **Dependencies**: All versions must match tech-stack specification exactly [Source: tech-stack.md]

**Repository Configuration:**
- **Monorepo Structure**: Single repository with services/ directory containing all 3 services [Source: source-tree.md#Root Directory Structure]
- **Container Strategy**: Each service has its own Dockerfile for ECS Fargate deployment [Source: source-tree.md#Services Directory Structure]
- **Development Environment**: Docker Compose for local development stack [Source: source-tree.md#Root Directory Structure]

### Testing

#### Testing Framework and Standards
- **Framework**: Go standard testing package [Source: architecture.md#Unit Tests]
- **File Convention**: `{filename}_test.go` in same directory [Source: architecture.md#Unit Tests]
- **Location**: Alongside implementation files [Source: architecture.md#Unit Tests]
- **Mocking Library**: gomock for interfaces [Source: architecture.md#Unit Tests]
- **Coverage Requirement**: 85% for business logic, minimum 80% overall [Source: architecture.md#Unit Tests]

#### Test Organization
- **Unit Tests**: 60% of test pyramid - test individual functions and methods [Source: architecture.md#Testing Philosophy]
- **Integration Tests**: 30% of test pyramid - located in `tests/integration/` [Source: architecture.md#Integration Tests]
- **End-to-End Tests**: 10% of test pyramid - full workflow testing [Source: architecture.md#Testing Philosophy]

#### Testing Infrastructure
- **Redis Testing**: miniredis for in-memory testing [Source: architecture.md#Integration Tests]
- **Test Data**: Fixtures in `tests/fixtures/` directory [Source: architecture.md#Test Data Management]
- **Test Environment**: Docker Compose with all services [Source: architecture.md#End-to-End Tests]

#### AI Agent Testing Requirements
- Generate tests for all public methods [Source: architecture.md#Unit Tests]
- Cover edge cases and error conditions [Source: architecture.md#Unit Tests]
- Follow AAA pattern (Arrange, Act, Assert) [Source: architecture.md#Unit Tests]
- Mock all external dependencies [Source: architecture.md#Unit Tests]

### Project Structure Notes
Current project structure lacks the 3-service architecture directories (services/frontend/, services/backend/, services/mcp-service/, infrastructure/). This story establishes the complete foundation structure as defined in the source-tree document with proper service separation. No structural conflicts identified - this is intentional scaffolding work for the 3-service containerized architecture.

## Change Log
| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-09-07 | 1.0.0 | Initial story creation for Epic 1.2 | Claude (AI Scrum Master) |
| 2025-09-09 | 1.1.0 | Updated to align with 3-service architecture, Mark3Labs MCP-Go, ECS Fargate deployment | Sarah (AI Product Owner) |

## Dev Agent Record
*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results
*Results from QA Agent review will be added here*