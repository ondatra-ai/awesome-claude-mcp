architecture:
  services:
    - name: frontend
      path: services/frontend
      language: typescript
      frameworks:
        - next.js
        - react
        - tailwindcss

      patterns:
        component-composition:
          description: "Build complex UIs from small, reusable components. Props down, events up."
          rules:
            - "Components receive data via props, never fetch directly"
            - "State lifted to nearest common ancestor"
            - "Use composition over inheritance"
        server-components:
          description: "Next.js RSC for data fetching. Client components only for interactivity."
          rules:
            - "Default to server components"
            - "Add 'use client' only when needed (hooks, browser APIs)"
            - "Fetch data in server components, pass to client"

      quality_gate:
        code:
          - name: eslint
            config: services/frontend/.eslintrc.json
          - name: typescript
            config: services/frontend/tsconfig.json
        tests:
          e2e:
            path: tests/e2e
            framework: playwright
            config: tests/playwright.config.ts
          integration:
            path: tests/integration
            framework: playwright
            config: tests/playwright.config.ts
          unit:
            path: services/frontend/__tests__
            framework: jest
            config: services/frontend/jest.config.js

      dependencies:
        - backend
        - mcp-service

    - name: backend
      path: services/backend
      language: go
      frameworks:
        - fiber
        - zerolog

      patterns:
        hexagonal-architecture:
          description: "Ports and adapters. Core domain isolated from external concerns via interfaces."
          rules:
            - "Domain defines ports (interfaces) in internal/domain/ports"
            - "Adapters implement ports in internal/adapters"
            - "Application layer in internal/application orchestrates use cases"
            - "No direct dependencies on frameworks in domain"
        error-handling:
          description: "Structured errors with context. Never swallow errors."
          rules:
            - "Use custom error types from internal/pkg/errors"
            - "Wrap errors with context: errors.Wrap(err, 'context')"
            - "Log at boundaries, propagate everywhere else"

      quality_gate:
        code:
          - name: golangci-lint
            config: services/backend/.golangci.yml
          - name: go-vet
            command: "go vet ./..."
        tests:
          e2e:
            path: tests/e2e
            framework: playwright
            config: tests/playwright.config.ts
          integration:
            path: tests/integration
            framework: playwright
            config: tests/playwright.config.ts
          unit:
            path: services/backend
            framework: go-test
            pattern: "*_test.go"

      dependencies: []

    - name: mcp-service
      path: services/mcp-service
      language: go
      frameworks:
        - fiber
        - zerolog
        - mcp-sdk

      patterns:
        hexagonal-architecture:
          description: "Same as backend - ports and adapters pattern."
          rules:
            - "Domain defines ports (interfaces) in internal/domain/ports"
            - "Adapters implement ports in internal/adapters"
            - "MCP handlers are adapters, not domain logic"

      quality_gate:
        code:
          - name: golangci-lint
            config: services/mcp-service/.golangci.yml
        tests:
          e2e:
            path: tests/e2e
            framework: playwright
          integration:
            path: tests/integration
            framework: playwright
          unit:
            path: services/mcp-service
            framework: go-test
            pattern: "*_test.go"

      dependencies:
        - backend
